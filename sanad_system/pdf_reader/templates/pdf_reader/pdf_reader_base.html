{% extends 'hadith_app/base.html' %}
{% load i18n static %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
    /* Custom styles for PDF Reader */
    .document-card {
        transition: transform 0.2s, box-shadow 0.2s;
        height: 100%;
    }
    
    .document-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
    }
    
    .document-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }
    
    .document-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 1;
    }
    
    .document-actions {
        position: absolute;
        top: 10px;
        left: 10px;
        right: 10px;
        display: none;
        justify-content: flex-end;
        z-index: 2;
    }
    
    .document-card:hover .document-actions {
        display: flex;
    }
    
    .document-thumbnail {
        height: 200px;
        background-color: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
    }
    
    .document-thumbnail img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
    }
    
    .document-meta {
        font-size: 0.85rem;
        color: #6c757d;
    }
    
    /* PDF Viewer Styles */
    .pdf-viewer-container {
        position: relative;
        width: 100%;
        height: calc(100vh - 150px);
        border: 1px solid #dee2e6;
        border-radius: 0.25rem;
        overflow: hidden;
    }
    
    .pdf-toolbar {
        background-color: #f8f9fa;
        border-bottom: 1px solid #dee2e6;
        padding: 0.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .pdf-pagination {
        display: flex;
        align-items: center;
    }
    
    .pdf-zoom {
        display: flex;
        align-items: center;
    }
    
    .pdf-page {
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: #525659;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
        .document-thumbnail {
            height: 150px;
        }
        
        .document-actions {
            display: flex !important; /* Always show on mobile */
            opacity: 0.9;
        }
    }
    
    /* Print styles */
    @media print {
        .no-print {
            display: none !important;
        }
        
        .document-actions {
            display: none !important;
        }
        
        .card {
            border: none !important;
            box-shadow: none !important;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
    {% block pdf_reader_content %}
    {% endblock %}
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
// Common JavaScript functions for PDF Reader
function confirmDelete(event, message) {
    if (!confirm(message || '{% trans "هل أنت متأكد من أنك تريد حذف هذا المستند؟" %}')) {
        event.preventDefault();
        return false;
    }
    return true;
}

// Format file size
function formatFileSize(bytes) {
    if (bytes === 0) return '0 B';
    const k = 1024;
    const sizes = ['B', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

// Initialize tooltips
document.addEventListener('DOMContentLoaded', function() {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
    
    // Update file sizes
    document.querySelectorAll('.file-size').forEach(function(el) {
        const bytes = parseInt(el.getAttribute('data-bytes'));
        if (!isNaN(bytes)) {
            el.textContent = formatFileSize(bytes);
        }
    });
});
</script>
{% endblock %}
