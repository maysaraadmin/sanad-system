{% extends "admin/base.html" %}
{% load static i18n %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
<style>
    :root {
        --primary: #4f46e5;
        --secondary: #6b7280;
        --success: #10b981;
        --info: #3b82f6;
        --warning: #f59e0b;
        --danger: #ef4444;
        --light: #f9fafb;
        --dark: #111827;
    }

    #header {
        background: var(--dark);
        color: white;
    }

    #branding h1 {
        color: white;
    }

    .module {
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        margin-bottom: 20px;
    }

    .module h2 {
        background: var(--primary);
        color: white;
        padding: 12px 15px;
        border-radius: 8px 8px 0 0;
        font-size: 16px;
    }

    .theme-switcher {
        display: flex;
        gap: 8px;
        margin-left: 15px;
    }

    .theme-btn {
        background: none;
        border: none;
        color: var(--light);
        cursor: pointer;
        padding: 5px;
        font-size: 1.1rem;
        transition: all 0.2s;
    }

    .theme-btn:hover {
        transform: scale(1.1);
    }

    .theme-btn.active {
        color: var(--primary);
    }

    /* Dark mode styles */
    [data-bs-theme="dark"] {
        --body-bg: #0f172a;
        --body-fg: #e2e8f0;
        --header-bg: #1e293b;
        --breadcrumbs-bg: #334155;
        --link-fg: #7ab8ff;
        --primary: #6366f1;
    }

    [data-bs-theme="dark"] body {
        background-color: var(--body-bg);
        color: var(--body-fg);
    }

    [data-bs-theme="dark"] #header {
        background-color: var(--header-bg);
    }

    [data-bs-theme="dark"] .breadcrumbs {
        background-color: var(--breadcrumbs-bg);
    }

    [data-bs-theme="dark"] a {
        color: var(--link-fg);
    }

    [data-bs-theme="dark"] .module {
        background-color: #1e293b;
        border: 1px solid #334155;
    }

    [data-bs-theme="dark"] .module h2 {
        background-color: var(--primary);
    }
</style>
{% endblock %}

{% block userlinks %}
<div class="theme-switcher">
    <button class="theme-btn {% if request.session.theme == 'light' %}active{% endif %}" data-theme="light" title="Light theme">
        <i class="bi bi-sun-fill"></i>
    </button>
    <button class="theme-btn {% if not request.session.theme or request.session.theme == 'auto' %}active{% endif %}" data-theme="auto" title="Auto theme">
        <i class="bi bi-circle-half"></i>
    </button>
    <button class="theme-btn {% if request.session.theme == 'dark' %}active{% endif %}" data-theme="dark" title="Dark theme">
        <i class="bi bi-moon-fill"></i>
    </button>
</div>
{{ block.super }}
{% endblock %}

{% block footer %}
{{ block.super }}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const themeBtns = document.querySelectorAll('.theme-btn');
    const html = document.documentElement;
    
    // Initialize theme from session or preference
    const savedTheme = "{{ request.session.theme|default:'auto' }}";
    html.setAttribute('data-bs-theme', savedTheme);
    
    themeBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const theme = this.getAttribute('data-theme');
            
            // Update active state
            themeBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Set theme
            html.setAttribute('data-bs-theme', theme);
            
            // Save preference
            fetch("{% url 'hadith_app:set_theme' %}", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: JSON.stringify({theme: theme})
            }).then(() => {
                window.location.reload();
            });
        });
    });
});
</script>
{% endblock %}